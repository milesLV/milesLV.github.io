"0","generate_combinations <- function(ops, nums) {"
"0","  # Convert to numeric if character"
"0","  nums <- as.numeric(nums)"
"0",""
"0","  # Generate all permutations of numbers"
"0","  permute <- function(v) {"
"0","    if (length(v) == 1) return(list(v))"
"0","    out <- list()"
"0","    for (i in seq_along(v)) {"
"0","      rest <- v[-i]"
"0","      for (p in permute(rest)) {"
"0","        out <- append(out, list(c(v[i], p)))"
"0","      }"
"0","    }"
"0","    return(out)"
"0","  }"
"0",""
"0","  # Parse operations into functions"
"0","  parse_op <- function(op_string) {"
"0","    if (op_string == ""+"") {"
"0","      return(function(x) x)"
"0","    } else if (op_string == ""-"") {"
"0","      return(function(x) -x)"
"0","    } else if (grepl(""^\\^"", op_string)) {"
"0","      n <- as.numeric(sub(""^\\^"", """", op_string))"
"0","      return(function(x) x^n)"
"0","    } else if (grepl(""^/"", op_string)) {"
"0","      n <- as.numeric(sub(""^/"", """", op_string))"
"0","      return(function(x) x / n)"
"0","    } else {"
"0","      stop(paste(""Unknown operation:"", op_string))"
"0","    }"
"0","  }"
"0",""
"0","  # Convert all ops to functions"
"0","  op_funcs <- lapply(ops, parse_op)"
"0",""
"0","  # Get all combinations of operations (each element gets an op)"
"0","  op_combos <- expand.grid(rep(list(seq_along(op_funcs)), length(nums)))"
"0","  "
"0","  # Generate number permutations"
"0","  num_perms <- permute(nums)"
"0",""
"0","  result <- list()"
"0",""
"0","  for (perm in num_perms) {"
"0","    for (i in 1:nrow(op_combos)) {"
"0","      indices <- as.integer(op_combos[i, ])"
"0","      funcs <- op_funcs[indices]"
"0","      transformed <- mapply(function(f, x) f(x), funcs, perm)"
"0","      result <- append(result, list(transformed))"
"0","    }"
"0","  }"
"0",""
"0","  return(result)"
"0","}"
"2","Warning: The working directory was changed to /Users/miles5 inside a notebook chunk. The working directory will be reset when the chunk is finished running. Use the knitr root.dir option in the setup chunk to change the working directory for notebook chunks."
"0","# generate_combinations(c(""+"", ""-""), c(1, 2))"
"0","makeKnightMoves <- function(position, board_size = 8){"
"0","  position <- as.numeric(position)"
"0",""
"0","  ifValid <- function(placement) {"
"0","    all(placement > 0 & placement <= board_size)"
"0","  }"
"0",""
"0","  if (length(position) != 2) {"
"0","    stop(""Position must have exactly 2 inputs"")"
"0","  } "
"0","  if (!ifValid(position)) {"
"0","    stop(""Please enter values between 1 and board size"")"
"0","  }"
"0",""
"0","  return("
"0","    compact(map(generate_combinations(c(""+"", ""-""), c(1, 2)), function(a){"
"0","      newPosition = c(position[1] + a[1], position[2] + a[2])"
"0","      if (ifValid(newPosition)){"
"0","        return(newPosition)"
"0","      }"
"0","    }))"
"0","  )"
"0","}"
"0",""
"0","makeKnightMoves(c(1,1))"
"1","[[1]]
"
"1","[1]"
"1"," 2"
"1"," 3"
"1","
"
"1","
"
"1","[[2]]
"
"1","[1]"
"1"," 3"
"1"," 2"
"1","
"
"1","
"
